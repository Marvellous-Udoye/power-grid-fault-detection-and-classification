# Power Grid Fault Detection and Classification using Machine Learning and a Hybrid CNN-LSTM Deep Learning Model

This project builds machine learning models to detect and classify electrical faults in transmission lines. It uses a simulated power system dataset (line currents and voltages) and explores classical ML, ensemble models, and a deep learning approach, with feature engineering guided by power systems domain knowledge.

**Research scope**
The system targets fault analysis on transmission lines, focusing on classification of fault types based on line current and voltage measurements. It also investigates how feature engineering can improve separation between hard-to-distinguish fault classes.

**Research objective**
Design and evaluate a fault detection and classification pipeline that combines ML baselines, ensemble methods, and a deep learning model. The deep learning track can be extended to a hybrid CNN-LSTM architecture for sequence-based feature learning.

**Research contributions**
- A reproducible pipeline for fault classification using line currents and voltages.
- A feature engineering approach (including zero sequence current and interaction terms) to improve model accuracy.
- Comparative evaluation across Decision Trees, Random Forest, XGBoost, LightGBM, CatBoost, and a deep learning model (TensorFlow).

**Dataset**
The dataset is generated by simulating a power system in MATLAB with four generators (11 x 10^3 V) and transformers. Faults are injected at the midpoint of the transmission line. Line voltages and line currents are recorded under normal and fault conditions. Nearly 12,000 labeled data points are collected.

Data files in this repo:
- `classData.csv`: Main labeled dataset with columns `G,C,B,A,Ia,Ib,Ic,Va,Vb,Vc`.
- `detect_dataset.csv`: Alternate dataset with `Output (S)` plus current and voltage measurements (header includes trailing empty columns).

Fault classes are derived by combining `G,C,B,A`. The notebook notes that only six fault classes appear in the dataset, including:
- No Fault
- Line A Line B to Ground Fault
- Three-Phase with Ground
- Line-to-Line AB
- Three-Phase
- Line-to-Line with Ground BC

**Setup (Windows, Python 3.x)**
Recommended: use a virtual environment.

```powershell
py -3 -m venv .venv
.\.venv\Scripts\activate
python -m pip install -r requirements.txt
```

Optional (for notebook use):

```powershell
python -m pip install ipykernel
```

Note: `numpy<2.0` is pinned for compatibility with `tensorflow==2.16.1`.

**Notebook usage**
Open `electrical-fault-detection-and-classification.ipynb`, select the project venv kernel, and run cells top to bottom. The notebook covers:
- Data loading and quality checks
- Fault class definition
- Exploratory data analysis
- Model training and evaluation
- Feature engineering and model interpretation

**Models and results (from the notebook)**
- Decision Tree: ~89.89% accuracy
- Random Forest: ~88.30% accuracy
- Ensemble models (XGBoost, LightGBM, CatBoost) show very strong performance; LightGBM and CatBoost achieve near-perfect test accuracy in the notebook results.

**Artifacts**
Trained models included in the repo:
- `decision_trees_model.pkl`
- `random_forest_model.pkl`
- `DL_model.pkl`

**Project structure**
```
.
|-- electrical-fault-detection-and-classification.ipynb
|-- classData.csv
|-- detect_dataset.csv
|-- requirements.txt
|-- decision_trees_model.pkl
|-- random_forest_model.pkl
|-- DL_model.pkl
`-- .gitignore
```
